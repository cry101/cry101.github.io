---
title: js的内存泄漏
date: 2020-09-02 16:02:26
tags: javascript
categories: Javascript
index_img: https://s2.loli.net/2023/01/31/wfzOKhdVeFpgU1R.jpg
---

### 内存泄漏的情况
内存泄漏一般是指系统进程不再用到的内存，没有及时释放，造成内存资源浪费，导致程序运行速度减慢甚至系统崩溃等严重后果。
造成内存泄漏的原因有：


#### （1）全局变量。
在局部作用域中，函数执行完毕后，变量就没有存在的必要了，垃圾回收机制很快的做出判断并回收；但是对于全局变量，很难判断什么时候不用这些变量，无法正常回收。
解决办法：
① 尽量少使用全局变量；
② 使用严格模式，在 js 文件头部或者函数的顶部加上use strict。


#### （2）闭包引起的内存泄露。
闭包可以读取函数内部的变量，然后让这些变量始终保存在内存中，如果在使用结束后没有将局部变量清除，就可能导致内存泄露。
解决办法：将事件处理函数定义在外部，解除闭包。


#### （3）被遗忘的定时器。
定时器setInterval或者setTimeout不再需要使用时，且没有被清除，导致定时器的回调函数及其内部依赖的变量都不能被回收，就会造成内存泄漏。
解决办法：当不需要定时器的时候，调用clearInterval或者clearTimeout手动清除。


#### （4）事件监听。
垃圾回收机制不好判断事件是否需要被解除，导致callback不能被释放，此时需要手动解除绑定。
解决办法：及时使用removeEventListener移除事件监听。


#### （5）元素引用没有清理。
解决办法：移除元素后，手动设置元素的引用为null。


#### （6）console。
传递给console.log的对象是不能被垃圾回收，可能会存在内存泄漏。
解决办法：清除不必要的console。

